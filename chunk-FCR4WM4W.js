import{a as q,b as Vt,c as Bt}from"./chunk-S3H3LLF7.js";import{a as z}from"./chunk-CK7JTE2X.js";import{b as Lt}from"./chunk-PFLXRLFW.js";import{a as B,b as Nt}from"./chunk-S7D5FPVQ.js";import{a as Rt}from"./chunk-UWPWH44U.js";import{a as Mt,b as _t,c as ht,d as bt,e as St,f as vt,g as xt,h as yt,i as Ot,j as Pt,l as Dt,m as wt}from"./chunk-ZMHGZXTC.js";import"./chunk-JJ2A35WS.js";import"./chunk-QLFZWSDB.js";import{a as Ut,b as Et,c as kt,e as Tt,f as Ft,g as It,h as At}from"./chunk-VE3VOWBG.js";import"./chunk-KMQDKAAG.js";import{b as A,c as N}from"./chunk-RFTLLO7Q.js";import{b as T,c as pt,f as ut,i as F,j as I}from"./chunk-LJJEMR6T.js";import"./chunk-PVDG46DZ.js";import{a as gt}from"./chunk-VN4UBBCE.js";import{a as R}from"./chunk-EQ7E6PNY.js";import{b as ft}from"./chunk-BT64ZR4J.js";import"./chunk-3HUEUM62.js";import"./chunk-S7KCO35Q.js";import{b as U,d as W,g as E,h as it,j as at,l as rt,n as mt,o as lt,r as st,t as ct,u as dt,w as k}from"./chunk-AMYPGFIW.js";import"./chunk-NQGOHOUR.js";import{m as ot,o as D,p as w}from"./chunk-2LKGOGN5.js";import{a as L,b as V}from"./chunk-NAFMYLXR.js";import"./chunk-PHPS4OQU.js";import{i as Ct}from"./chunk-NCMEPRDZ.js";import{G as O,H as P}from"./chunk-3GOW57GU.js";import{t as y}from"./chunk-HYNCXMIA.js";import{$b as f,Aa as u,Ab as M,Ac as et,Hc as nt,L as X,Ob as _,Pb as h,Q as Y,Ub as d,Vb as t,Wb as o,Xb as s,a as H,ac as g,ca as Z,cc as Q,hb as m,hc as p,jc as b,la as c,nb as tt,nc as $,oc as K,pc as J,qa as S,ra as v,ub as x,xc as a,yc as C}from"./chunk-N46UG6V3.js";function Wt(i,n){i&1&&(s(0,"mat-progress-spinner",8),t(1,"span"),a(2,"Saving..."),o())}function Xt(i,n){i&1&&(f(0),t(1,"mat-icon"),a(2,"save"),o(),t(3,"span"),a(4,"Save"),o(),g())}var G=class i{constructor(n){this.data=n;this.isEditMode.set(!!n.uom),this.editForm=this.fb.group({name:["",W.required],symbol:["",W.required]}),this.isEditMode()&&this.editForm.patchValue(n.uom)}fb=c(dt);adminSetupApi=c(z);snackBar=c(R);dialogRef=c(Ut);isSaving=u(!1);isEditMode=u(!1);editForm;onConfirm(){if(this.editForm.invalid)return;this.isSaving.set(!0);let n=this.editForm.value;if(this.isEditMode()){let e=H(H({},this.data.uom),n);this.adminSetupApi.updateUoM(e.id,e).subscribe({next:()=>this.handleSuccess("UoM updated successfully."),error:r=>this.handleError(r)})}else{let e=n;this.adminSetupApi.createUoM(e).subscribe({next:()=>this.handleSuccess("UoM created successfully."),error:r=>this.handleError(r)})}}handleSuccess(n){this.snackBar.open(n,"OK",{duration:3e3}),this.isSaving.set(!1),this.dialogRef.close(!0)}handleError(n){this.snackBar.open(`Error: ${n.error?.title||"Failed to save."}`,"Close"),this.isSaving.set(!1)}onCancel(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||i)(tt(Et))};static \u0275cmp=x({type:i,selectors:[["app-uom-dialog"]],decls:25,vars:4,consts:[["mat-dialog-title","",1,"dialog-title"],[1,"edit-form",3,"formGroup"],["appearance","outline"],["matInput","","formControlName","name","required","","cdkFocusInitial","","placeholder","e.g., Kilogram, Case"],["matInput","","formControlName","symbol","required","","placeholder","e.g., Kg, CS"],["align","end"],["mat-button","",3,"click"],["mat-flat-button","","color","primary",3,"click","disabled"],["diameter","20","mode","indeterminate"]],template:function(e,r){e&1&&(t(0,"h2",0)(1,"mat-icon"),a(2,"straighten"),o(),t(3,"span"),a(4),o()(),t(5,"mat-dialog-content")(6,"form",1)(7,"mat-form-field",2)(8,"mat-label"),a(9,"Name"),o(),s(10,"input",3),t(11,"mat-error"),a(12,"Name is required"),o()(),t(13,"mat-form-field",2)(14,"mat-label"),a(15,"Symbol"),o(),s(16,"input",4),t(17,"mat-error"),a(18,"Symbol is required"),o()()()(),t(19,"mat-dialog-actions",5)(20,"button",6),p("click",function(){return r.onCancel()}),a(21,"Cancel"),o(),t(22,"button",7),p("click",function(){return r.onConfirm()}),_(23,Wt,3,0)(24,Xt,5,0,"ng-container"),o()()),e&2&&(m(4),C(r.isEditMode()?"Edit Unit of Measure":"New Unit of Measure"),m(2),d("formGroup",r.editForm),m(16),d("disabled",r.editForm.invalid||r.isSaving()),m(),h(r.isSaving()?23:24))},dependencies:[y,k,rt,U,E,it,ct,lt,st,At,Tt,It,Ft,w,D,I,F,T,pt,N,A,V,L,P,O,Lt],styles:[".dialog-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.edit-form[_ngcontent-%COMP%]{min-width:400px;padding-top:1rem;display:flex;flex-direction:column;gap:1rem}button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%] + span[_ngcontent-%COMP%], button[_ngcontent-%COMP%]   mat-progress-spinner[_ngcontent-%COMP%] + span[_ngcontent-%COMP%]{margin-left:8px}"]})};var Yt=()=>[5,10,25];function Zt(i,n){i&1&&(t(0,"div",11),s(1,"mat-progress-spinner",12),t(2,"span"),a(3,"Loading units of measure..."),o()())}function te(i,n){i&1&&(t(0,"th",27),a(1,"Unit Name"),o())}function ee(i,n){if(i&1&&(t(0,"td",28)(1,"div",29)(2,"span",30),a(3),o(),t(4,"span",31),a(5),o()()()),i&2){let e=n.$implicit;m(3),C(e.name),m(2),C(e.symbol)}}function ne(i,n){i&1&&(t(0,"th",27),a(1,"Symbol"),o())}function oe(i,n){if(i&1&&(t(0,"td",32)(1,"code"),a(2),o()()),i&2){let e=n.$implicit;m(2),C(e.symbol)}}function ie(i,n){i&1&&(t(0,"th",33),a(1,"Actions"),o())}function ae(i,n){if(i&1){let e=Q();t(0,"td",34)(1,"button",35),p("click",function(){let l=S(e).$implicit,j=b(2);return v(j.openDialog(l))}),t(2,"mat-icon"),a(3,"edit"),o()(),t(4,"button",36),p("click",function(){let l=S(e).$implicit,j=b(2);return v(j.onDelete(l))}),t(5,"mat-icon"),a(6,"delete"),o()()()}}function re(i,n){i&1&&s(0,"tr",37)}function me(i,n){i&1&&s(0,"tr",38)}function le(i,n){if(i&1){let e=Q();t(0,"div",25)(1,"div",39)(2,"mat-icon"),a(3,"straighten"),o()(),t(4,"h3"),a(5,"No units of measure found"),o(),t(6,"p"),a(7,"Get started by creating your first unit of measure"),o(),t(8,"button",40),p("click",function(){S(e);let l=b(2);return v(l.openDialog())}),t(9,"mat-icon"),a(10,"add"),o(),t(11,"span"),a(12,"Create UoM"),o()()()}}function se(i,n){if(i&1&&(t(0,"div",13)(1,"table",14),f(2,15),M(3,te,2,0,"th",16)(4,ee,6,2,"td",17),g(),f(5,18),M(6,ne,2,0,"th",16)(7,oe,3,1,"td",19),g(),f(8,20),M(9,ie,2,0,"th",21)(10,ae,7,0,"td",22),g(),M(11,re,1,0,"tr",23)(12,me,1,0,"tr",24),o(),_(13,le,13,0,"div",25),o(),s(14,"mat-paginator",26)),i&2){let e=b();m(),d("dataSource",e.dataSource),m(10),d("matHeaderRowDef",e.displayedColumns),m(),d("matRowDefColumns",e.displayedColumns),m(),h(e.dataSource.data.length===0&&!e.isLoading()?13:-1),m(),d("length",e.resultsLength())("pageSize",10)("pageSizeOptions",nt(7,Yt))}}var zt=class i{adminSetupApi=c(z);snackBar=c(R);dialog=c(kt);isLoading=u(!1);dataSource=new wt([]);displayedColumns=["name","symbol","actions"];resultsLength=u(0);searchControl=new at("");paginator;sort;ngOnInit(){this.searchControl.valueChanges.pipe(X(300),Y(),Z(()=>{this.paginator&&this.paginator.firstPage(),this.loadData()})).subscribe()}ngAfterViewInit(){this.loadData(),this.sort.sortChange.subscribe(()=>{this.paginator&&this.paginator.firstPage(),this.loadData()}),this.paginator.page.subscribe(()=>{this.loadData()})}loadData(){this.isLoading.set(!0);let n=this.sort?.direction==="asc"||this.sort?.direction==="desc"?this.sort.direction:void 0,e={page:this.paginator?this.paginator.pageIndex+1:1,pageSize:this.paginator?this.paginator.pageSize:10,sortBy:this.sort?this.sort.active:"name",sortDirection:n,searchTerm:this.searchControl.value||void 0};this.adminSetupApi.getPagedUoMs(e).subscribe({next:r=>{this.resultsLength.set(r.totalCount),this.dataSource.data=r.items,this.isLoading.set(!1)},error:r=>{console.error("Failed to load UoMs:",r),this.snackBar.open("Failed to load Units of Measure.","Close",{duration:3e3}),this.isLoading.set(!1),this.dataSource.data=[]}})}refreshList(){this.loadData()}openDialog(n){this.dialog.open(G,{width:"450px",data:{uom:n}}).afterClosed().subscribe(r=>{r===!0&&this.refreshList()})}onDelete(n){this.dialog.open(Rt,{data:{title:"Delete Unit of Measure",message:`Are you sure you want to delete "${n.name}" (${n.symbol})? This cannot be undone.`}}).afterClosed().subscribe(r=>{r===!0&&this.adminSetupApi.deleteUoM(n.id).subscribe({next:()=>{this.snackBar.open("Unit of Measure deleted.","OK",{duration:3e3}),this.refreshList()},error:l=>{this.snackBar.open(`Error: ${l.error?.title||"Failed to delete."}`,"Close")}})})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=x({type:i,selectors:[["app-uom-setup"]],viewQuery:function(e,r){if(e&1&&($(B,5),$(q,5)),e&2){let l;K(l=J())&&(r.paginator=l.first),K(l=J())&&(r.sort=l.first)}},decls:23,vars:4,consts:[[1,"setup-container"],[1,"header-section"],[1,"header-content"],[1,"list-title"],[1,"list-subtitle"],["mat-flat-button","","color","primary",1,"create-button",3,"click"],[1,"search-section"],["appearance","outline",1,"search-bar",2,"margin-top","1.5rem"],["matInput","","placeholder","Search by name or symbol",3,"formControl"],["matSuffix",""],[1,"results-count"],[1,"spinner-container"],["mode","indeterminate","diameter","40"],[1,"table-container"],["mat-table","","matSort","",1,"uom-table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","name-cell",4,"matCellDef"],["matColumnDef","symbol"],["mat-cell","",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","actions-column",4,"matHeaderCellDef"],["mat-cell","","class","actions-column",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","uom-row",4,"matRowDef","matRowDefColumns"],[1,"empty-state"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"name-cell"],[1,"name-content"],[1,"uom-name"],[1,"uom-symbol"],["mat-cell",""],["mat-header-cell","",1,"actions-column"],["mat-cell","",1,"actions-column"],["mat-icon-button","","color","primary","matTooltip","Edit UoM",3,"click"],["mat-icon-button","","color","warn","matTooltip","Delete UoM",3,"click"],["mat-header-row",""],["mat-row","",1,"uom-row"],[1,"empty-icon"],["mat-flat-button","","color","primary",3,"click"]],template:function(e,r){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),a(4,"Units of Measure"),o(),t(5,"p",4),a(6,"Manage measurement units used across your inventory system"),o()(),t(7,"button",5),p("click",function(){return r.openDialog()}),t(8,"mat-icon"),a(9,"add"),o(),t(10,"span"),a(11,"New UoM"),o()()(),t(12,"div",6)(13,"mat-form-field",7)(14,"mat-label"),a(15,"Search UoMs..."),o(),s(16,"input",8),t(17,"mat-icon",9),a(18,"search"),o()(),t(19,"div",10),a(20),o()(),_(21,Zt,4,0,"div",11)(22,se,15,8),o()),e&2&&(m(16),d("formControl",r.searchControl),m(4),et(" ",r.dataSource.data.length," of ",r.resultsLength()," units "),m(),h(r.isLoading()?21:22))},dependencies:[y,k,U,E,mt,Ct,I,F,T,ut,N,A,w,D,ot,P,O,V,L,Dt,Mt,ht,xt,bt,_t,yt,St,vt,Ot,Pt,Nt,B,Bt,q,Vt,gt,ft],styles:["[_nghost-%COMP%]{display:block;height:100%;padding:1.5rem 2.5rem}.setup-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.header-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:1rem;padding-bottom:1rem;border-bottom:1px solid var(--mat-sys-outline-variant)}.header-section[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex:1}.header-section[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .list-title[_ngcontent-%COMP%]{margin:0;font-weight:600;font-size:1.75rem;color:var(--mat-sys-on-surface)}.header-section[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .list-subtitle[_ngcontent-%COMP%]{margin:.25rem 0 0;color:var(--mat-sys-on-surface-variant);font-size:.9rem}.header-section[_ngcontent-%COMP%]   .create-button[_ngcontent-%COMP%]{flex-shrink:0}.header-section[_ngcontent-%COMP%]   .create-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:.5rem}.search-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:1rem;flex-wrap:wrap}.search-section[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]{flex:1;min-width:300px}.search-section[_ngcontent-%COMP%]   .results-count[_ngcontent-%COMP%]{color:var(--mat-sys-on-surface-variant);font-size:.875rem;white-space:nowrap}.spinner-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:1rem;padding:3rem;color:var(--mat-sys-on-surface-variant)}.table-container[_ngcontent-%COMP%]{background:var(--mat-sys-surface);border:1px solid var(--mat-sys-outline-variant);border-radius:8px;overflow:hidden;flex:1;display:flex;flex-direction:column}.uom-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.uom-table[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{background-color:var(--mat-sys-surface-container-low);color:var(--mat-sys-on-surface-variant);font-weight:600;font-size:.875rem;padding:1rem;border-bottom:1px solid var(--mat-sys-outline-variant)}.uom-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid var(--mat-sys-outline-variant);vertical-align:middle}.uom-table[_ngcontent-%COMP%]   .uom-row[_ngcontent-%COMP%]{cursor:pointer;transition:background-color .2s ease}.uom-table[_ngcontent-%COMP%]   .uom-row[_ngcontent-%COMP%]:hover{background-color:var(--mat-sys-surface-container-hover)}.uom-table[_ngcontent-%COMP%]   .uom-row[_ngcontent-%COMP%]:last-child   .mat-cell[_ngcontent-%COMP%]{border-bottom:none}.name-cell[_ngcontent-%COMP%]   .name-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.name-cell[_ngcontent-%COMP%]   .name-content[_ngcontent-%COMP%]   .uom-name[_ngcontent-%COMP%]{font-weight:500;color:var(--mat-sys-on-surface)}.name-cell[_ngcontent-%COMP%]   .name-content[_ngcontent-%COMP%]   .uom-symbol[_ngcontent-%COMP%]{font-size:.8rem;color:var(--mat-sys-on-surface-variant);font-family:monospace}.actions-column[_ngcontent-%COMP%]{white-space:nowrap;width:120px}.actions-column[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 .25rem}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:4rem 2rem;color:var(--mat-sys-on-surface-variant)}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:80px;height:80px;border-radius:50%;background-color:var(--mat-sys-surface-container-high);margin-bottom:1.5rem}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2.5rem;width:2.5rem;height:2.5rem;color:var(--mat-sys-on-surface-variant)}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.5rem;font-weight:500;color:var(--mat-sys-on-surface)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1.5rem;font-size:1rem;max-width:400px;line-height:1.5}.empty-state[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:.5rem}mat-paginator[_ngcontent-%COMP%]{border-top:1px solid var(--mat-sys-outline-variant)}@media (max-width: 768px){[_nghost-%COMP%]{padding:1rem}.header-section[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:1rem}.header-section[_ngcontent-%COMP%]   .create-button[_ngcontent-%COMP%]{align-self:flex-end}.search-section[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:.75rem}.search-section[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]{min-width:unset}.search-section[_ngcontent-%COMP%]   .results-count[_ngcontent-%COMP%]{align-self:flex-end}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.table-container[_ngcontent-%COMP%]   .uom-table[_ngcontent-%COMP%]{min-width:600px}}"]})};export{zt as UomSetupComponent};
