import{a as xt,b as vt,c as Mt}from"./chunk-4MA2X27T.js";import"./chunk-MS4AQ6UA.js";import{d as mt}from"./chunk-LDLFMV26.js";import{a as ft,c as ht,f as _t,h as Ct}from"./chunk-MXUZQ3DV.js";import"./chunk-KMQDKAAG.js";import{b as pt,c as st}from"./chunk-RFTLLO7Q.js";import{b as et,d as nt,e as it,f as ot,i as at,j as rt}from"./chunk-LJJEMR6T.js";import{a as ut}from"./chunk-BVME6BF5.js";import"./chunk-3HUEUM62.js";import"./chunk-2G5JFWHB.js";import{b as W,d as Y,g as Q,h as q,l as K,o as J,r as X,u as Z,w as tt}from"./chunk-AMYPGFIW.js";import"./chunk-KS7NA3UJ.js";import{m as H,o as I,p as E}from"./chunk-2LKGOGN5.js";import{a as T,b as N}from"./chunk-NAFMYLXR.js";import{a as lt}from"./chunk-SVDPSKVI.js";import{a as k}from"./chunk-2G4RJFBR.js";import{a as ct,e as dt,i as gt}from"./chunk-NCMEPRDZ.js";import{G as D,H as A}from"./chunk-3GOW57GU.js";import{A as U,B as w,o as R,t as O}from"./chunk-HYNCXMIA.js";import{Aa as c,H as V,Lc as B,Nc as $,Ob as _,Pb as C,Sb as b,Tb as S,Ub as f,Vb as e,Wb as i,Xb as x,_ as j,cc as y,ga as z,hb as p,hc as l,jc as h,la as m,qa as g,ra as u,tc as P,ub as M,w as L,xc as a,yc as d}from"./chunk-N46UG6V3.js";var F=class o{http=m(w);apiUrl=`${k.apiUrl}/Shipping`;warehouseState=m(lt);getShippableGroups(){let t=this.warehouseState.selectedWarehouseId();if(!t)throw new Error("Cannot get shippable groups: No warehouse is selected.");let n=new U().set("warehouseId",t);return this.http.get(`${this.apiUrl}/ready-to-ship`,{params:n})}shipGoods(t){return this.http.post(`${this.apiUrl}/ship`,t)}static \u0275fac=function(n){return new(n||o)};static \u0275prov=z({token:o,factory:o.\u0275fac,providedIn:"root"})};var kt=(o,t)=>t.id;function Dt(o,t){o&1&&(e(0,"div",6),x(1,"mat-progress-spinner",11),i())}function At(o,t){if(o&1&&(e(0,"mat-option",17)(1,"div",18)(2,"span",19),a(3),i(),e(4,"span",20),a(5),B(6,"date"),i()()()),o&2){let n=t.$implicit;f("value",n),p(3),d(n.licensePlate),p(2),d($(6,3,n.startTime,"shortTime"))}}function It(o,t){o&1&&(e(0,"mat-hint"),a(1,"No trucks currently at an outbound dock."),i())}function Et(o,t){if(o&1){let n=y();e(0,"form",7)(1,"mat-form-field",12)(2,"mat-label"),a(3,"Search Truck at Dock"),i(),e(4,"mat-icon",13),a(5,"local_shipping"),i(),e(6,"input",14,0),l("click",function(){g(n);let s=P(7);return u(s.openPanel())}),i(),a(8," cdkFocusInitial> "),e(9,"button",15),l("click",function(s){return g(n),P(7).openPanel(),u(s.stopPropagation())}),e(10,"mat-icon"),a(11,"arrow_drop_down"),i()(),e(12,"mat-autocomplete",16,1),l("optionSelected",function(s){g(n);let v=h();return u(v.onAppointmentSelected(s.option.value))}),b(14,At,7,6,"mat-option",17,kt),i(),_(16,It,2,0,"mat-hint"),i()()}if(o&2){let n=P(13),r=h();f("formGroup",r.form),p(6),f("matAutocomplete",n),p(6),f("displayWith",r.displayAppointmentName),p(2),S(r.filteredAppointments()),p(2),C(r.appointments().length===0?16:-1)}}var G=class o{http=m(w);fb=m(Z);dialogRef=m(ft);appointments=c([]);filteredAppointments=c([]);isLoading=c(!0);form;constructor(){this.form=this.fb.group({appointmentId:["",Y.required],appointmentSearch:[""]})}ngOnInit(){this.http.get(`${k.apiUrl}/Lookups/outbound-appointments`).subscribe({next:t=>{this.appointments.set(t),this.isLoading.set(!1),this.setupFilter()},error:()=>this.isLoading.set(!1)})}setupFilter(){this.form.get("appointmentSearch")?.valueChanges.pipe(j(""),L(t=>this._filter(t||""))).subscribe(t=>this.filteredAppointments.set(t))}_filter(t){let n=t.toLowerCase();return this.appointments().filter(r=>r.licensePlate.toLowerCase().includes(n))}displayAppointmentName(t){return t?.licensePlate||""}onAppointmentSelected(t){this.form.get("appointmentId")?.setValue(t.id)}onConfirm(){this.form.valid&&this.dialogRef.close({appointmentId:this.form.value.appointmentId})}onCancel(){this.dialogRef.close()}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=M({type:o,selectors:[["app-select-appointment-dialog"]],decls:15,vars:2,consts:[["trigger","matAutocompleteTrigger"],["autoAppointment","matAutocomplete"],[1,"dialog-container"],[1,"dialog-header"],["mat-icon-button","",3,"click"],[1,"dialog-content"],[1,"spinner-container"],[3,"formGroup"],[1,"dialog-actions"],["mat-stroked-button","",3,"click"],["mat-flat-button","","color","primary",3,"click","disabled"],["mode","indeterminate","diameter","40"],["appearance","outline","subscriptSizing","dynamic"],["matPrefix",""],["type","text","placeholder","Enter license plate...","matInput","","formControlName","appointmentSearch",3,"click","matAutocomplete"],["mat-icon-button","","matSuffix","",3,"click"],[3,"optionSelected","displayWith"],[3,"value"],[1,"option-layout"],[1,"license-plate"],[1,"start-time"]],template:function(n,r){n&1&&(e(0,"div",2)(1,"div",3)(2,"h2"),a(3,"Assign to Outbound Truck"),i(),e(4,"button",4),l("click",function(){return r.onCancel()}),e(5,"mat-icon"),a(6,"close"),i()()(),e(7,"mat-dialog-content",5),_(8,Dt,2,0,"div",6)(9,Et,17,4,"form",7),i(),e(10,"div",8)(11,"button",9),l("click",function(){return r.onCancel()}),a(12,"Cancel"),i(),e(13,"button",10),l("click",function(){return r.onConfirm()}),a(14," Confirm Shipment "),i()()()),n&2&&(p(8),C(r.isLoading()?8:9),p(5),f("disabled",r.form.invalid))},dependencies:[O,tt,K,W,Q,q,J,X,Ct,_t,E,I,H,rt,at,et,nt,it,ot,st,pt,Mt,xt,mt,vt,N,T,A,D,R],styles:[".dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:400px;background:#fff}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.5rem 1.5rem 1rem;border-bottom:1px solid #e2e8f0}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:600;color:#0f172a}.dialog-content[_ngcontent-%COMP%]{padding:1.5rem!important;display:flex;flex-direction:column;gap:1.5rem}.spinner-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:2rem}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.dialog-actions[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-top:1px solid #e2e8f0;display:flex;justify-content:flex-end;gap:.75rem;background:#f8fafc}.option-layout[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%}.option-layout[_ngcontent-%COMP%]   .license-plate[_ngcontent-%COMP%]{font-weight:500;color:#0f172a}.option-layout[_ngcontent-%COMP%]   .start-time[_ngcontent-%COMP%]{font-size:.85rem;color:#64748b}"]})};var Tt=(o,t)=>t.accountId;function Nt(o,t){o&1&&(e(0,"div",4),x(1,"mat-progress-spinner",6),e(2,"p"),a(3,"Loading Orders..."),i()())}function Ft(o,t){if(o&1){let n=y();e(0,"mat-card",7)(1,"div",9)(2,"div",10)(3,"div",11)(4,"mat-icon",12),a(5,"inventory"),i(),e(6,"span",13),a(7),i()(),e(8,"div",14),a(9," Awaiting Shipment "),i()(),e(10,"div",15)(11,"div",16)(12,"span",17),a(13,"Items"),i(),e(14,"span",18),a(15),i()(),x(16,"div",19),e(17,"div",16)(18,"span",17),a(19,"Units"),i(),e(20,"span",18),a(21),i()()()(),e(22,"mat-card-actions",20)(23,"button",21),l("click",function(){let s=g(n).$implicit,v=h(2);return u(v.onShip(s))}),e(24,"mat-icon"),a(25,"local_shipping"),i(),e(26,"span"),a(27,"Ship Order"),i()()()()}if(o&2){let n=t.$implicit;p(7),d(n.accountName),p(8),d(n.itemCount),p(6),d(n.totalQuantity)}}function Gt(o,t){o&1&&(e(0,"div",8)(1,"mat-icon"),a(2,"all_inbox"),i(),e(3,"h2"),a(4,"No Orders Ready"),i(),e(5,"p"),a(6,"There are no fully picked orders awaiting shipment."),i()())}function Lt(o,t){if(o&1&&(e(0,"div",5),b(1,Ft,28,3,"mat-card",7,Tt,!1,Gt,7,0,"div",8),i()),o&2){let n=h();p(),S(n.groups())}}var St=class o{shippingApi=m(F);snackBar=m(ut);dialog=m(ht);groups=c([]);isLoading=c(!0);ngOnInit(){this.loadShippableGroups()}loadShippableGroups(){this.isLoading.set(!0),this.shippingApi.getShippableGroups().subscribe({next:t=>{this.groups.set(t),this.isLoading.set(!1)},error:()=>{this.snackBar.open("Failed to load groups ready for shipping.","Close"),this.isLoading.set(!1)}})}onShip(t){this.dialog.open(G,{width:"500px",data:{group:t}}).afterClosed().pipe(V(r=>!!r)).subscribe(r=>{this.shippingApi.shipGoods({appointmentId:r.appointmentId,shipmentNumber:`SHIP-${Date.now()}`,pickTransactionIds:t.pickTransactionIds}).subscribe({next:()=>{this.snackBar.open(`Order for ${t.accountName} marked as shipped!`,"OK",{duration:4e3}),this.loadShippableGroups()},error:s=>this.snackBar.open(`Error: ${s.error?.title||"Could not complete shipment."}`,"Close")})})}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=M({type:o,selectors:[["app-shipping"]],decls:9,vars:1,consts:[[1,"report-container"],[1,"header-section"],[1,"mat-headline-6"],[1,"mat-body-1"],[1,"spinner-container-page"],[1,"groups-grid"],["mode","indeterminate"],[1,"group-card"],[1,"empty-list-message"],[1,"card-content-wrapper"],[1,"info-section"],[1,"account-row"],[1,"account-icon"],[1,"account-name"],[1,"status-row"],[1,"stats-section"],[1,"stat-item"],[1,"label"],[1,"value"],[1,"divider"],["align","end",1,"compact-actions"],["mat-flat-button","","color","primary",3,"click"]],template:function(n,r){n&1&&(e(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),a(4,"Ready for Shipping"),i(),e(5,"p",3),a(6,"Consolidated pick lists ready to be loaded and dispatched."),i()()(),_(7,Nt,4,0,"div",4)(8,Lt,4,1,"div",5),i()),n&2&&(p(7),C(r.isLoading()?7:8))},dependencies:[O,gt,ct,dt,E,I,A,D,N,T],styles:["[_nghost-%COMP%]{display:block;height:100%}.report-container[_ngcontent-%COMP%]{padding:1.5rem 2rem;max-width:1600px;margin:0 auto;display:flex;flex-direction:column;gap:2rem;height:100%;animation:_ngcontent-%COMP%_fadeIn .3s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.header-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1rem;padding-bottom:1rem;border-bottom:1px solid var(--mat-sys-outline-variant)}.header-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:600;margin:0 0 .5rem;color:var(--mat-sys-on-surface);letter-spacing:-.02em}.header-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--mat-sys-on-surface-variant);font-size:1rem;max-width:600px}.spinner-container-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:1rem;padding:3rem;min-height:300px;color:var(--mat-sys-on-surface-variant);flex-grow:1}.groups-grid[_ngcontent-%COMP%]{display:grid;gap:1rem;grid-template-columns:repeat(auto-fill,minmax(400px,1fr));align-items:start}.group-card[_ngcontent-%COMP%]{border:1px solid var(--mat-sys-outline-variant);box-shadow:none;border-radius:12px;padding:0;display:flex;flex-direction:column;background-color:var(--mat-sys-surface);transition:transform .2s ease,box-shadow .2s ease}.group-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 8px #0000000d}.card-content-wrapper[_ngcontent-%COMP%]{padding:1.5rem;display:flex;justify-content:space-between;align-items:flex-start;gap:1.5rem;flex-wrap:wrap}.info-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;flex:1;min-width:200px}.account-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.account-row[_ngcontent-%COMP%]   .account-icon[_ngcontent-%COMP%]{color:var(--mat-sys-primary);font-size:1.5rem;width:1.5rem;height:1.5rem;flex-shrink:0}.account-row[_ngcontent-%COMP%]   .account-name[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:var(--mat-sys-on-surface);line-height:1.3}.status-row[_ngcontent-%COMP%]{font-size:.9rem;color:var(--mat-sys-on-surface-variant);padding-left:2.25rem;font-weight:500;text-transform:uppercase;letter-spacing:.05em}.stats-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem;background-color:var(--mat-sys-surface-container-low);padding:.75rem 1.25rem;border-radius:8px;flex-shrink:0}.stats-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.25rem}.stats-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.7rem;text-transform:uppercase;color:var(--mat-sys-on-surface-variant);font-weight:600;letter-spacing:.05em}.stats-section[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:var(--mat-sys-primary);line-height:1}.stats-section[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:1px;height:24px;background-color:var(--mat-sys-outline-variant)}.compact-actions[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background-color:var(--mat-sys-surface-container-lowest);border-top:1px solid var(--mat-sys-outline-variant-low);gap:.75rem}.compact-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]     .mat-mdc-button-touch-target{height:40px}.empty-list-message[_ngcontent-%COMP%]{grid-column:1/-1;display:flex;flex-direction:column;justify-content:center;align-items:center;min-height:300px;text-align:center;gap:1rem;padding:2rem;color:var(--mat-sys-on-surface-variant);border:2px dashed var(--mat-sys-outline-variant-low);border-radius:12px}.empty-list-message[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:4rem;width:4rem;height:4rem;color:var(--mat-sys-outline);opacity:.5}.empty-list-message[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:500;color:var(--mat-sys-on-surface)}.empty-list-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1rem}@media (max-width: 768px){.report-container[_ngcontent-%COMP%]{padding:1rem}.card-content-wrapper[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:1.5rem}.stats-section[_ngcontent-%COMP%]{justify-content:space-around;width:100%;box-sizing:border-box}}"]})};export{St as ShippingComponent};
