import{a as u}from"./chunk-LWYKMW7M.js";import{B as c}from"./chunk-GEABFLPO.js";import{Rc as n,Z as i,ba as s,ga as a,va as l}from"./chunk-FZDPWNP7.js";var g=class r{http=a(c);TOKEN_KEY="wms_auth_token";apiUrl=u.apiUrl;currentUser=l(null);isLoggedIn=n(()=>!!this.currentUser());currentUserRole=n(()=>this.currentUser()?.role??null);constructor(){let e=this.getToken();e&&this.currentUser.set(this._decodeToken(e))}register(e){return this.http.post(`${this.apiUrl}/Authentication/register`,e)}login(e,t){let p={email:e,password:t};return this.http.post(`${this.apiUrl}/Authentication/login`,p).pipe(i(o=>{this.setToken(o.token),this.currentUser.set(this._decodeToken(o.token))}))}logout(){localStorage.removeItem(this.TOKEN_KEY),this.currentUser.set(null)}hasRole(e){let t=this.currentUserRole();return t==="Admin"?!0:t===e}getToken(){return localStorage.getItem(this.TOKEN_KEY)}setToken(e){localStorage.setItem(this.TOKEN_KEY,e)}_decodeToken(e){if(!e)return null;try{let t=e.split(".")[1];return JSON.parse(atob(t))}catch(t){return console.error("Failed to decode token",t),null}}static \u0275fac=function(t){return new(t||r)};static \u0275prov=s({token:r,factory:r.\u0275fac,providedIn:"root"})};export{g as a};
