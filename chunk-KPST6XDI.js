import{a as de}from"./chunk-2RVOOXGT.js";import{a as Y,b as Z,c as ee,d as te,e as ne,f as ie,g as ae,h as oe,i as re,j as le,l as ce}from"./chunk-GEIZTYKY.js";import{b as z,e as H,h as A}from"./chunk-PZORATZK.js";import{a as K}from"./chunk-ORD52YGC.js";import"./chunk-JYCF7ZPK.js";import"./chunk-RZ3EY26M.js";import"./chunk-5JMQ54DL.js";import{p as q,q as F}from"./chunk-AFJ6IJZO.js";import{a as W,b as X}from"./chunk-67FWL4YT.js";import"./chunk-VD2AZ2LQ.js";import"./chunk-LWYKMW7M.js";import{a as U,b as $,c as V,d as Q,f as G,i as J}from"./chunk-TFYOF5WW.js";import"./chunk-ZKJQ6NKM.js";import{H as N,I as j}from"./chunk-6GGLSGMC.js";import{h as k,o as L,q as T,r as B,t as R}from"./chunk-GEABFLPO.js";import{Gc as l,Ic as _,Jb as b,Kb as O,Kc as C,Pb as m,Qb as e,Rb as t,Sb as M,W as h,Wb as p,Xb as g,Zb as S,cb as r,cc as I,ec as x,ga as P,la as y,ma as w,pb as D,sc as n,tc as d,uc as v,va as u,vb as s,vc as E}from"./chunk-FZDPWNP7.js";import"./chunk-AP4OEWII.js";function se(i,o){i&1&&(e(0,"div",0),M(1,"mat-progress-spinner",2),t())}function pe(i,o){i&1&&(M(0,"mat-progress-spinner",40),e(1,"span"),n(2,"Loading..."),t())}function ge(i,o){i&1&&(p(0),e(1,"mat-icon"),n(2,"print"),t(),e(3,"span"),n(4,"Print/Preview"),t(),g())}function _e(i,o){i&1&&(e(0,"th",41),n(1," Description "),t())}function Ce(i,o){if(i&1&&(e(0,"td",42)(1,"span",43),n(2),t()()),i&2){let a=o.$implicit;r(2),d(a.description)}}function ue(i,o){i&1&&(e(0,"th",44),n(1," Quantity "),t())}function Me(i,o){if(i&1&&(e(0,"td",45),n(1),l(2,"number"),t()),i&2){let a=o.$implicit;r(),v(" ",_(2,1,a.quantity,"1.2-2")," ")}}function fe(i,o){i&1&&(e(0,"th",44),n(1," Unit Rate "),t())}function Pe(i,o){if(i&1&&(e(0,"td",45),n(1),l(2,"currency"),t()),i&2){let a=o.$implicit;r(),v(" ",C(2,1,a.unitRate,"PHP","symbol","1.2-2")," ")}}function ve(i,o){i&1&&(e(0,"th",44),n(1," Amount "),t())}function be(i,o){if(i&1&&(e(0,"td",46)(1,"strong"),n(2),l(3,"currency"),t()()),i&2){let a=o.$implicit;r(2),d(C(3,1,a.amount,"PHP","symbol","1.2-2"))}}function Oe(i,o){i&1&&M(0,"tr",47)}function xe(i,o){i&1&&M(0,"tr",48)}function he(i,o){if(i&1){let a=S();e(0,"div",1)(1,"div",3)(2,"div",4)(3,"a",5)(4,"mat-icon"),n(5,"arrow_back"),t(),e(6,"span"),n(7,"Back to List"),t()(),e(8,"div",6)(9,"div",7)(10,"h1",8),n(11),t(),e(12,"span",9),n(13),t()(),e(14,"p",10),n(15,"Billing details and line items"),t()()(),e(16,"div",11)(17,"button",12),I("click",function(){y(a);let f=x();return w(f.loadPdfPreview())}),b(18,pe,3,0)(19,ge,5,0,"ng-container"),t(),e(20,"button",13)(21,"mat-icon"),n(22,"payments"),t(),e(23,"span"),n(24,"Mark as Paid"),t()()()(),e(25,"mat-card",14)(26,"mat-card-content")(27,"div",15)(28,"div",16)(29,"span",17),n(30,"Account"),t(),e(31,"span",18),n(32),t()(),e(33,"div",16)(34,"span",17),n(35,"Invoice Date"),t(),e(36,"span",18),n(37),l(38,"date"),t()(),e(39,"div",16)(40,"span",17),n(41,"Due Date"),t(),e(42,"span",18),n(43),l(44,"date"),t()(),e(45,"div",16)(46,"span",17),n(47,"Billing Period"),t(),e(48,"span",18),n(49),l(50,"date"),l(51,"date"),t()()()()(),e(52,"mat-card",19)(53,"mat-card-header")(54,"mat-card-title"),n(55,"Invoice Line Items"),t(),e(56,"mat-card-subtitle"),n(57,"Detailed breakdown of charges"),t()(),e(58,"mat-card-content",20)(59,"div",21)(60,"table",22),p(61,23),s(62,_e,2,0,"th",24)(63,Ce,3,1,"td",25),g(),p(64,26),s(65,ue,2,0,"th",27)(66,Me,3,4,"td",28),g(),p(67,29),s(68,fe,2,0,"th",27)(69,Pe,3,6,"td",28),g(),p(70,30),s(71,ve,2,0,"th",27)(72,be,4,6,"td",31),g(),s(73,Oe,1,0,"tr",32)(74,xe,1,0,"tr",33),t()(),e(75,"div",34)(76,"div",35)(77,"div",36)(78,"span",37),n(79,"Subtotal"),t(),e(80,"span",38),n(81),l(82,"currency"),t()(),e(83,"div",36)(84,"span",37),n(85,"Tax"),t(),e(86,"span",38),n(87),l(88,"currency"),t()(),e(89,"div",39)(90,"span",37),n(91,"Total Amount Due"),t(),e(92,"span",38),n(93),l(94,"currency"),t()()()()()()()}if(i&2){let a=o,c=x();r(11),v("Invoice ",a.invoiceNumber),r(),m("ngClass",a.status.toLowerCase()),r(),d(a.status),r(4),m("disabled",c.isLoadingPdf()),r(),O(c.isLoadingPdf()?18:19),r(2),m("disabled",a.status!=="Issued"),r(12),d(a.name),r(5),d(_(38,17,a.periodStart,"longDate")),r(6),d(_(44,20,a.dueDate,"longDate")),r(6),E("",_(50,23,a.periodStart,"shortDate")," - ",_(51,26,a.periodEnd,"shortDate")),r(11),m("dataSource",a.lines),r(13),m("matHeaderRowDef",c.displayedColumns),r(),m("matRowDefColumns",c.displayedColumns),r(7),d(C(82,29,a.totalAmount-a.taxAmount,"PHP","symbol","1.2-2")),r(6),d(C(88,34,a.taxAmount,"PHP","symbol","1.2-2")),r(6),d(C(94,39,a.totalAmount,"PHP","symbol","1.2-2"))}}function ye(i,o){i&1&&(e(0,"div",1)(1,"mat-card",49)(2,"mat-card-content",50)(3,"mat-icon",51),n(4,"error_outline"),t(),e(5,"div",52)(6,"h2",53),n(7,"Invoice Not Found"),t(),e(8,"p",54),n(9," The requested invoice could not be found or may have been removed. "),t()(),e(10,"a",55)(11,"mat-icon"),n(12,"arrow_back"),t(),e(13,"span"),n(14,"Return to Invoice List"),t()()()()())}var me=class i{route=P(z);billingApi=P(de);snackBar=P(K);invoice=u(null);isLoading=u(!0);invoiceId=u("");isLoadingPdf=u(!1);displayedColumns=["description","quantity","unitRate","amount"];ngOnInit(){this.route.paramMap.pipe(h(o=>{let a=o.get("id");if(!a)throw this.isLoading.set(!1),new Error("No invoice ID provided");return this.invoiceId.set(a),this.billingApi.getInvoiceById(a)})).subscribe({next:o=>{this.invoice.set(o),this.isLoading.set(!1)},error:()=>{this.isLoading.set(!1)}})}loadPdfPreview(){this.isLoadingPdf.set(!0),this.billingApi.getInvoicePdf(this.invoiceId()).subscribe({next:o=>{let a=new Blob([o],{type:"application/pdf"}),c=URL.createObjectURL(a);window.open(c,"_blank"),this.isLoadingPdf.set(!1)},error:o=>{console.error(o),this.snackBar.open("Failed to load PDF preview.","Close",{duration:5e3}),this.isLoadingPdf.set(!1)}})}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=D({type:i,selectors:[["app-invoice-detail"]],decls:3,vars:1,consts:[[1,"spinner-container"],[1,"invoice-container"],["mode","indeterminate"],[1,"detail-header"],[1,"header-main"],["mat-stroked-button","","routerLink","/billing",1,"back-button"],[1,"header-title-section"],[1,"title-group"],[1,"invoice-title"],[1,"status-badge",3,"ngClass"],[1,"invoice-subtitle"],[1,"header-actions"],["mat-stroked-button","","color","primary",1,"action-button",3,"click","disabled"],["mat-stroked-button","","color","primary",1,"action-button",3,"disabled"],[1,"summary-card"],[1,"summary-grid"],[1,"summary-item"],[1,"summary-label"],[1,"summary-value"],[1,"line-items-card"],[1,"card-content"],[1,"table-container"],["mat-table","",1,"line-items-table",3,"dataSource"],["matColumnDef","description"],["mat-header-cell","","class","description-header",4,"matHeaderCellDef"],["mat-cell","","class","description-cell",4,"matCellDef"],["matColumnDef","quantity"],["mat-header-cell","","class","number-header",4,"matHeaderCellDef"],["mat-cell","","class","number-cell",4,"matCellDef"],["matColumnDef","unitRate"],["matColumnDef","amount"],["mat-cell","","class","number-cell amount-cell",4,"matCellDef"],["mat-header-row","","class","table-header-row",4,"matHeaderRowDef"],["mat-row","","class","table-row",4,"matRowDef","matRowDefColumns"],[1,"invoice-totals"],[1,"totals-container"],[1,"total-row"],[1,"total-label"],[1,"total-value"],[1,"total-row","grand-total"],["diameter","20","mode","indeterminate",2,"margin-right","8px"],["mat-header-cell","",1,"description-header"],["mat-cell","",1,"description-cell"],[1,"line-description"],["mat-header-cell","",1,"number-header"],["mat-cell","",1,"number-cell"],["mat-cell","",1,"number-cell","amount-cell"],["mat-header-row","",1,"table-header-row"],["mat-row","",1,"table-row"],[1,"error-card"],[1,"error-content"],[1,"error-icon"],[1,"error-text"],[1,"error-title"],[1,"error-description"],["mat-stroked-button","","routerLink","/billing",1,"error-action"]],template:function(a,c){if(a&1&&b(0,se,2,0,"div",0)(1,he,95,44,"div",1)(2,ye,15,0,"div",1),a&2){let f;O(c.isLoading()?0:(f=c.invoice())?1:2,f)}},dependencies:[R,k,A,H,J,U,V,G,Q,$,F,q,j,N,ce,Y,ee,ae,te,Z,oe,ne,ie,re,le,X,W,T,B,L],styles:[".spinner-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:400px;padding:2rem}.invoice-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;display:flex;flex-direction:column;gap:1rem;padding:1rem}.detail-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;padding:0}.detail-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;flex:1;min-width:min-content}.detail-header[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{border-radius:6px;height:32px;line-height:32px;padding:0 12px;font-size:.85rem}.detail-header[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.1rem;width:1.1rem;height:1.1rem;margin-right:4px}.detail-header[_ngcontent-%COMP%]   .header-title-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.15rem}.detail-header[_ngcontent-%COMP%]   .header-title-section[_ngcontent-%COMP%]   .title-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.detail-header[_ngcontent-%COMP%]   .header-title-section[_ngcontent-%COMP%]   .invoice-title[_ngcontent-%COMP%]{margin:0;font-size:1.35rem;font-weight:600;line-height:1.2;color:var(--mat-sys-on-surface)}.detail-header[_ngcontent-%COMP%]   .header-title-section[_ngcontent-%COMP%]   .invoice-subtitle[_ngcontent-%COMP%]{margin:0;font-size:.75rem;color:var(--mat-sys-on-surface-variant)}.detail-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.detail-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{border-radius:6px;height:36px;font-size:.85rem;padding:0 12px}.detail-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:.4rem;font-size:1.1rem;width:1.1rem;height:1.1rem}.summary-card[_ngcontent-%COMP%]{border-radius:8px;box-shadow:none!important;border:1px solid var(--mat-sys-outline-variant)}.summary-card[_ngcontent-%COMP%]   .mat-mdc-card-content[_ngcontent-%COMP%]{padding:1rem}.summary-card[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem}.summary-card[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.15rem}.summary-card[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{font-size:.7rem;font-weight:600;color:var(--mat-sys-on-surface-variant);text-transform:uppercase;letter-spacing:.5px}.summary-card[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{font-size:.9rem;font-weight:500;color:var(--mat-sys-on-surface)}.line-items-card[_ngcontent-%COMP%]{border-radius:8px;box-shadow:none!important;border:1px solid var(--mat-sys-outline-variant);overflow:hidden}.line-items-card[_ngcontent-%COMP%]   .mat-mdc-card-header[_ngcontent-%COMP%]{padding:.75rem 1rem;background-color:var(--mat-sys-surface-container-low);border-bottom:1px solid var(--mat-sys-outline-variant)}.line-items-card[_ngcontent-%COMP%]   .mat-mdc-card-header[_ngcontent-%COMP%]   .mat-mdc-card-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;margin-bottom:0}.line-items-card[_ngcontent-%COMP%]   .mat-mdc-card-header[_ngcontent-%COMP%]   .mat-mdc-card-subtitle[_ngcontent-%COMP%]{display:none}.line-items-card[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{padding:0}.line-items-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{overflow-x:auto}.line-items-card[_ngcontent-%COMP%]   .line-items-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.line-items-card[_ngcontent-%COMP%]   .line-items-table[_ngcontent-%COMP%]   .table-header-row[_ngcontent-%COMP%]{height:36px}.line-items-card[_ngcontent-%COMP%]   .line-items-table[_ngcontent-%COMP%]   .table-header-row[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;color:var(--mat-sys-on-surface-variant);border-bottom:1px solid var(--mat-sys-outline-variant);padding:0 1rem;text-transform:uppercase}.line-items-card[_ngcontent-%COMP%]   .line-items-table[_ngcontent-%COMP%]   .table-header-row[_ngcontent-%COMP%]   th.number-header[_ngcontent-%COMP%]{text-align:right}.line-items-card[_ngcontent-%COMP%]   .line-items-table[_ngcontent-%COMP%]   .table-header-row[_ngcontent-%COMP%]   th.description-header[_ngcontent-%COMP%]{text-align:left}.line-items-card[_ngcontent-%COMP%]   .line-items-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]{height:40px;transition:background-color .1s ease}.line-items-card[_ngcontent-%COMP%]   .line-items-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]:hover{background-color:var(--mat-sys-surface-container-high)}.line-items-card[_ngcontent-%COMP%]   .line-items-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid var(--mat-sys-outline-variant);padding:.25rem 1rem;font-size:.85rem}.line-items-card[_ngcontent-%COMP%]   .line-items-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.number-cell[_ngcontent-%COMP%]{text-align:right;font-variant-numeric:tabular-nums}.line-items-card[_ngcontent-%COMP%]   .line-items-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.description-cell[_ngcontent-%COMP%]   .line-description[_ngcontent-%COMP%]{line-height:1.2}.line-items-card[_ngcontent-%COMP%]   .line-items-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.amount-cell[_ngcontent-%COMP%]{font-weight:600}.line-items-card[_ngcontent-%COMP%]   .line-items-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.invoice-totals[_ngcontent-%COMP%]{padding:.75rem 1rem;background-color:var(--mat-sys-surface-container-lowest);border-top:1px solid var(--mat-sys-outline-variant)}.invoice-totals[_ngcontent-%COMP%]   .totals-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:.25rem}.invoice-totals[_ngcontent-%COMP%]   .totals-container[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;max-width:250px;padding:.15rem 0;align-items:center}.invoice-totals[_ngcontent-%COMP%]   .totals-container[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   .total-label[_ngcontent-%COMP%]{font-size:.8rem;color:var(--mat-sys-on-surface-variant)}.invoice-totals[_ngcontent-%COMP%]   .totals-container[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   .total-value[_ngcontent-%COMP%]{font-size:.9rem;font-weight:500;font-variant-numeric:tabular-nums}.invoice-totals[_ngcontent-%COMP%]   .totals-container[_ngcontent-%COMP%]   .total-row.grand-total[_ngcontent-%COMP%]{border-top:1px solid var(--mat-sys-outline-variant);margin-top:.25rem;padding-top:.5rem}.invoice-totals[_ngcontent-%COMP%]   .totals-container[_ngcontent-%COMP%]   .total-row.grand-total[_ngcontent-%COMP%]   .total-label[_ngcontent-%COMP%]{font-size:.9rem;font-weight:700;color:var(--mat-sys-on-surface)}.invoice-totals[_ngcontent-%COMP%]   .totals-container[_ngcontent-%COMP%]   .total-row.grand-total[_ngcontent-%COMP%]   .total-value[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:var(--mat-sys-primary)}.error-card[_ngcontent-%COMP%]{border-radius:8px;text-align:center;max-width:400px;margin:2rem auto;box-shadow:none!important;border:1px solid var(--mat-sys-outline-variant)}.error-card[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]{padding:2rem;display:flex;flex-direction:column;align-items:center;gap:1rem}.error-card[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem;color:var(--mat-sys-error);opacity:.8}.error-card[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]   .error-title[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:600}.error-card[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]   .error-description[_ngcontent-%COMP%]{margin:.5rem 0 0;font-size:.9rem;color:var(--mat-sys-on-surface-variant)}.status-badge[_ngcontent-%COMP%]{padding:2px 8px;border-radius:4px;font-size:.7rem;font-weight:700;letter-spacing:.05em;border:1px solid;line-height:1;text-transform:uppercase}.status-badge.draft[_ngcontent-%COMP%], .status-badge.issued[_ngcontent-%COMP%], .status-badge.paid[_ngcontent-%COMP%], .status-badge.overdue[_ngcontent-%COMP%]{color:var(--color);background-color:var(--bg);border-color:var(--border)}.status-badge.draft[_ngcontent-%COMP%]{--bg: #f1f5f9;--color: #475569;--border: #cbd5e1}.status-badge.issued[_ngcontent-%COMP%]{--bg: #e0f7fa;--color: #00838f;--border: #4dd0e1}.status-badge.paid[_ngcontent-%COMP%]{--bg: #e8f5e9;--color: #2e7d32;--border: #81c784}.status-badge.overdue[_ngcontent-%COMP%]{--bg: #ffebee;--color: #c62828;--border: #ef9a9a}@media (max-width: 768px){.detail-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:.75rem}.detail-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]{flex-wrap:wrap}.summary-card[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}"]})};export{me as InvoiceDetailComponent};
